

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Monitoring Your Service &mdash; Daeploy  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Cross-service Communication" href="cross_service_communication.html" />
    <link rel="prev" title="Schedule Repeating Actions" href="ticker.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/daeploy_white.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview/daeploy_description.html">Daeploy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/compatibility.html">Version compatibility</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom_service.html">Anatomy of a Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="dashboard.html">Dashboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="service_logs.html">Read Logs From Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="autodocs.html">API Autodocs</a></li>
<li class="toctree-l1"><a class="reference internal" href="notifications.html">Notifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="shadow_deployment.html">Versioning and Shadow Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="reaching_service_from_external_applications.html">Reaching a service from external applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="ticker.html">Schedule Repeating Actions</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Monitoring Your Service</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#monitoring-variables">Monitoring Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="#monitoring-an-entrypoint">Monitoring an Entrypoint</a></li>
<li class="toctree-l2"><a class="reference internal" href="#monitoring-a-parameter">Monitoring a Parameter</a></li>
<li class="toctree-l2"><a class="reference internal" href="#getting-the-data">Getting the Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#limiting-the-number-of-records-in-the-database">Limiting the Number of Records in the Database</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cross_service_communication.html">Cross-service Communication</a></li>
</ul>
<p class="caption"><span class="caption-text">Advanced User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../advanced_tutorials/sdk_typing.html">Typing in the SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced_tutorials/using_multiple_hosts.html">Using Multiple Hosts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced_tutorials/manager_api.html">Manager API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced_tutorials/adv_deploy.html">Deployment Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced_tutorials/cli_autocompletion.html">Autocompletion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced_tutorials/service_environment.html">Service Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced_tutorials/manager_configuration.html">Manager Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced_tutorials/testing_services.html">Testing Services Before Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced_tutorials/proxy_dashboard.html">Proxy Dashboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced_tutorials/upload_image.html">Upload local docker image</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced_tutorials/status_codes.html">HTTP Status Codes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced_tutorials/integration_with_other_tools.html">Connecting Daeploy with Other Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced_tutorials/going_beyond_sdk.html">Going Beyond the SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced_tutorials/daeploy_notebook_service.html">Work With Daeploy From a Notebook</a></li>
</ul>
<p class="caption"><span class="caption-text">Special Usecases</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../special_usecases/deploying_ml_model.html">Deploying Machine Learning Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../special_usecases/ui_streamlit.html">Using Streamlit to build a dashboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="../special_usecases/ui_plotly_dash.html">Using Plotly Dash to build a dashboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="../special_usecases/conda.html">Using Daeploy with Conda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../special_usecases/gpu_services.html">Access NVIDIA GPUs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../special_usecases/hosting_static_html.html">Host static HTML pages using Daeploy</a></li>
</ul>
<p class="caption"><span class="caption-text">Api Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api_reference/cli.html">Command-line Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_reference/sdk.html">Software Development Kit</a></li>
</ul>
<p class="caption"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../3rd_party_software.html">3rd party software</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Daeploy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Monitoring Your Service</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/content/getting_started/monitoring.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="monitoring-your-service">
<span id="monitoring-reference"></span><h1>Monitoring Your Service<a class="headerlink" href="#monitoring-your-service" title="Permalink to this headline">¶</a></h1>
<p>Monitoring is a very important aspect of software deployment. Deployed algorithms
often deteriorate over time, in a process called
<a class="reference external" href="https://en.wikipedia.org/wiki/Domain_adaptation">domain shift</a>, and being able
to monitor your deployed algorithms can make all the difference in detecting this
in the early stages.</p>
<div class="section" id="monitoring-variables">
<h2>Monitoring Variables<a class="headerlink" href="#monitoring-variables" title="Permalink to this headline">¶</a></h2>
<p>To monitor the value of a variable in the code you can use the
<code class="xref py py-func docutils literal notranslate"><span class="pre">store()</span></code> function. It takes an arbitrary number of keyword
arguments and saves their values in a service-specific database, where they can be
retrieved at a later time. <code class="xref py py-func docutils literal notranslate"><span class="pre">store()</span></code> supports numeric and
string data. Let’s use the <cite>hello</cite> service as an example</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">daeploy</span> <span class="kn">import</span> <span class="n">service</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">service</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s2">&quot;greeting_phrase&quot;</span><span class="p">,</span> <span class="s2">&quot;Hello&quot;</span><span class="p">)</span>

<span class="nd">@service</span><span class="o">.</span><span class="n">entrypoint</span>
<span class="k">def</span> <span class="nf">hello</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="n">greeting_phrase</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get_parameter</span><span class="p">(</span><span class="s2">&quot;greeting_phrase&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Greeting someone with the name: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Now the name and greeting will be stored everytime this function is called</span>
    <span class="n">service</span><span class="o">.</span><span class="n">store</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">greeting</span><span class="o">=</span><span class="n">greeting_phrase</span><span class="p">)</span>

    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">greeting_phrase</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="monitoring-an-entrypoint">
<h2>Monitoring an Entrypoint<a class="headerlink" href="#monitoring-an-entrypoint" title="Permalink to this headline">¶</a></h2>
<p>It is also possible to automatically monitor the input and output of a service
entrypoint. To do this we pass <code class="docutils literal notranslate"><span class="pre">monitor=True</span></code> to the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">entrypoint()</span></code> decorator</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">daeploy</span> <span class="kn">import</span> <span class="n">service</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">service</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s2">&quot;greeting_phrase&quot;</span><span class="p">,</span> <span class="s2">&quot;Hello&quot;</span><span class="p">)</span>

<span class="c1"># Now the input and output of this entrypoint is stored after each call</span>
<span class="nd">@service</span><span class="o">.</span><span class="n">entrypoint</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">hello</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="n">greeting_phrase</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get_parameter</span><span class="p">(</span><span class="s2">&quot;greeting_phrase&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Greeting someone with the name: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">greeting_phrase</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p>In this case, the data is saved as json strings, in order to support more data
formats.</p>
</div>
<div class="section" id="monitoring-a-parameter">
<h2>Monitoring a Parameter<a class="headerlink" href="#monitoring-a-parameter" title="Permalink to this headline">¶</a></h2>
<p>Parameters set with <code class="xref py py-func docutils literal notranslate"><span class="pre">add_parameter()</span></code> can also be monitored by passing
<code class="docutils literal notranslate"><span class="pre">monitor=True</span></code>, which also supports integer, float and string data</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">daeploy</span> <span class="kn">import</span> <span class="n">service</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="c1"># Now the value of ``&quot;greeting_phrase&quot;`` is stored every time it&#39;s updated</span>
<span class="n">service</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s2">&quot;greeting_phrase&quot;</span><span class="p">,</span> <span class="s2">&quot;Hello&quot;</span><span class="p">,</span> <span class="n">monitor</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nd">@service</span><span class="o">.</span><span class="n">entrypoint</span>
<span class="k">def</span> <span class="nf">hello</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="n">greeting_phrase</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get_parameter</span><span class="p">(</span><span class="s2">&quot;greeting_phrase&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Greeting someone with the name: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">greeting_phrase</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="getting-the-data">
<h2>Getting the Data<a class="headerlink" href="#getting-the-data" title="Permalink to this headline">¶</a></h2>
<p>Daeploy provides three options for accessing the time-series data for
your monitored variables.</p>
<p><strong>Option 1: Json format</strong></p>
<p>The time-series data in json format can be collected via the following entrypoint:</p>
<p><code class="docutils literal notranslate"><span class="pre">http://your-host/services/&lt;servce_name&gt;_&lt;service_version&gt;/~monitor</span></code></p>
<p>It is possible to specify start time and end time for the wanted time-series data by adding
<cite>end</cite> and <cite>start</cite> query parameters to the url, like this:</p>
<p><code class="docutils literal notranslate"><span class="pre">http://your-host/services/&lt;servce&gt;_&lt;service_version&gt;/~monitor?end=&lt;...&gt;?start=&lt;...&gt;</span></code></p>
<p>The <cite>end</cite> and <cite>start</cite> query parameters needs to have the following format:
<code class="docutils literal notranslate"><span class="pre">YYYY-MM-DD[T]HH:MM[:SS[.ffffff]][Z</span> <span class="pre">or</span> <span class="pre">[±]HH[:]MM]]]</span></code>, so for instance: 2020-01-01 02:30</p>
<p>It it also possible to specify which variables to query time-series by specify the query parameter
<cite>variables</cite>, like this:</p>
<p><code class="docutils literal notranslate"><span class="pre">http://your-host/services/&lt;servce_name&gt;_&lt;service_version&gt;/~monitor?end=&lt;...&gt;?start=&lt;...&gt;?variables=v1?variables=v2</span></code></p>
<p>This will query time-series data for variable <cite>a</cite> and <cite>b</cite>. The returned json time-series data will be on the following format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">tn</span><span class="p">]</span>
        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">vn</span><span class="p">]</span>
        <span class="p">}</span>
    <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">tn</span><span class="p">]</span>
        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">vn</span><span class="p">]</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Example, using the <a class="reference external" href="https://requests.readthedocs.io/en/master/">requests</a>
package in python:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">GET</span><span class="p">(</span>
    <span class="s2">&quot;services/name_version/~monitor&quot;</span><span class="p">,</span>
    <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Authorization&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Bearer </span><span class="si">{</span><span class="n">TOKEN</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">})</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Option 2: CSV files</strong></p>
<p>The time-series data can also be returned in csv format, the entrypoint for this is:</p>
<p><code class="docutils literal notranslate"><span class="pre">http://your-host/services/&lt;servce_name&gt;_&lt;service_version&gt;/~csv</span></code></p>
<p>It is possible to specify, which variables and in during which time interval to query
time-series data for by using the following query parameters:
<cite>end</cite>, <cite>start</cite> and <cite>varaibles</cite>. For instance:</p>
<p><code class="docutils literal notranslate"><span class="pre">http://your-host/services/&lt;servce_name&gt;_&lt;service_version&gt;/~monitor/csv?end=&lt;...&gt;?start=&lt;...&gt;?variables=v1?variables=v2</span></code></p>
<p>The <cite>end</cite> and <cite>start</cite> query parameters needs to have the following format:
<code class="docutils literal notranslate"><span class="pre">YYYY-MM-DD[T]HH:MM[:SS[.ffffff]][Z</span> <span class="pre">or</span> <span class="pre">[±]HH[:]MM]]]</span></code>, so for instance: 2020-01-01 02:30</p>
<p>This will query time-series data for variable <cite>a</cite> and <cite>b</cite>.This entrypoint returns a zip file containing one csv file per requested variable.
The csv files has the following format:</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>timestamp</p></th>
<th class="head"><p>value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>t1</p></td>
<td><p>v1</p></td>
</tr>
<tr class="row-odd"><td><p>t2</p></td>
<td><p>v2</p></td>
</tr>
</tbody>
</table>
<p><strong>Option 3: The whole service database</strong></p>
<p>The time-series data is stored a in sqlite databases and the whole
service database can be requested at the following entrypoint:</p>
<p><code class="docutils literal notranslate"><span class="pre">http://your-host/services/&lt;servce_name&gt;_&lt;service_version&gt;/~monitor/db</span></code></p>
</div>
<div class="section" id="limiting-the-number-of-records-in-the-database">
<h2>Limiting the Number of Records in the Database<a class="headerlink" href="#limiting-the-number-of-records-in-the-database" title="Permalink to this headline">¶</a></h2>
<p>Service databases are not intended to be permanent data storage. Records are kept for
90 days by default, but if a service stores large amounts of data often there is a
risk of filling the disk of the host machine. To prevent this it’s possible to change
how many instances of each variable can be stored or to automatically remove old instances.
The database is cleaned at even intervals.</p>
<p>These options are set using a pair of environment variable in the service’s runtime.
The easiest way to set these are in <cite>.s2i/environment</cite>:</p>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt>DAEPLOY_SERVICE_DB_TABLE_LIMIT</dt><dd><ul>
<li><p>Should have the format &lt;number&gt;&lt;limiter&gt;</p></li>
<li><p>Limiter options: rows, days, hours, minutes or seconds.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>DAEPLOY_SERVICE_DB_CLEAN_INTERVAL</dt><dd><ul>
<li><p>Should have the format &lt;number&gt;&lt;limiter&gt;</p></li>
<li><p>Limiter options: days, hours, minutes or seconds.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<p>To limit the number of days to store variables to 30 we would add the following
to <cite>.s2i/environment</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DAEPLOY_SERVICE_DB_TABLE_LIMIT</span><span class="o">=</span><span class="mi">30</span><span class="n">days</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="cross_service_communication.html" class="btn btn-neutral float-right" title="Cross-service Communication" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="ticker.html" class="btn btn-neutral float-left" title="Schedule Repeating Actions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Viking Analytics AB.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Other Versions</span>
    v: develop
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Tags</dt>
      <dd><a href="../../../1.0.0/content/getting_started/monitoring.html">1.0.0</a></dd>
      <dd><a href="../../../1.0.0-beta/content/getting_started/monitoring.html">1.0.0-beta</a></dd>
      <dd><a href="../../../1.0.1/content/getting_started/monitoring.html">1.0.1</a></dd>
      <dd><a href="../../../1.0.2/content/getting_started/monitoring.html">1.0.2</a></dd>
      <dd><a href="../../../1.1.0/content/getting_started/monitoring.html">1.1.0</a></dd>
      <dd><a href="../../../1.1.1/content/getting_started/monitoring.html">1.1.1</a></dd>
    </dl>
    <dl>
      <dt>Branches</dt>
      <dd><a href="monitoring.html">develop</a></dd>
    </dl>
  </div>
</div>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>